<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sticky Notes</title>
    <link rel="stylesheet" href="padlet.css">
    <link rel="icon" type="image/x-icon" href="/image/logo.png">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>

        <nav>
            <a href="" class="active">Home</a>
            <a href="/policies">Policies</a>
            <a href="/awareness">Awareness</a>
            <a href="/defense">Self-Defense</a>
            <a href="/services">App & Services</a>
            <a href="/solution">ChatBot</a>
            <a href="padlet.html">Padlet</a>
        </nav>

    </header>
    <h1>My Sticky Notes</h1>
    <div id="notes-container"></div>
    
    <!-- Modal for input -->
    <div id="noteModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2>Create a New Note</h2>
            <input type="text" id="name" placeholder="Your Name"><br>
            <input type="text" id="title" placeholder="Note Title"><br>
            <textarea id="message" placeholder="Your Message"></textarea><br>
            <button id="saveNoteBtn">Save Note</button>
        </div>
    </div>

    <button class="add-note-btn" id="addNoteBtn">+</button>

    <script>
        document.getElementById('addNoteBtn').addEventListener('click', function() {
            document.getElementById('noteModal').style.display = 'flex';
        });
        
        document.getElementsByClassName('close-btn')[0].addEventListener('click', function() {
            document.getElementById('noteModal').style.display = 'none';
        });
        
        document.getElementById('saveNoteBtn').addEventListener('click', async function() {
            const name = document.getElementById('name').value;
            const title = document.getElementById('title').value;
            const message = document.getElementById('message').value;
            
            if (name && title && message) {
                const newNote = {
                    name: name,
                    title: title,
                    message: message
                };

                // Send the note to the server
                const response = await fetch('/save-note', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(newNote)
                });

                if (response.ok) {
                    addNoteToPage(name, title, message);
                    document.getElementById('noteModal').style.display = 'none';
                    // Clear input fields after saving
                    document.getElementById('name').value = '';
                    document.getElementById('title').value = '';
                    document.getElementById('message').value = '';
                } else {
                    alert('Error saving note!');
                }
            } else {
                alert('Please fill out all fields!');
            }
        });
        
        function addNoteToPage(name, title, message) {
            const noteContainer = document.createElement('div');
            noteContainer.className = 'note';
        
            const noteTitle = document.createElement('h3');
            noteTitle.innerText = title;
        
            const noteMessage = document.createElement('p');
            noteMessage.innerText = message;
        
            const noteAuthor = document.createElement('p');
            noteAuthor.style.fontStyle = 'italic';
            noteAuthor.innerText = `By: ${name}`;
        
            noteContainer.appendChild(noteTitle);
            noteContainer.appendChild(noteMessage);
            noteContainer.appendChild(noteAuthor);
        
            document.getElementById('notes-container').appendChild(noteContainer);
        }

        // Fetch existing notes when the page loads
        async function loadNotes() {
            const response = await fetch('/notes');
            if (response.ok) {
                const notes = await response.json();
                notes.forEach(note => {
                    addNoteToPage(note.name, note.title, note.message);
                });
            } else {
                console.error('Failed to load notes');
            }
        }

        // Call loadNotes when the script loads
        loadNotes();
    </script>
</body>
</html>
